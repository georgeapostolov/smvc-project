<?	if (false) {		$user = $success = $error = false;	}	$this->view->set_css('public/css/login.css');	$this->view->display('includes/header');?><h1 style="text-align: center; margin-bottom: 50px;"><a href="<?= ROOT_URL; ?>profile">Profile</a> &middot; Two-factor authentication</h1>	<? if ($user->data['tfa_enabled']) { ?>	<form name="disable_tfa_form" method="post" action="">		<input type="hidden" name="action" value="tfa_disable" />		<div id="login">			<div id="top">2FA is <span class="green">ENABLED</span></div>			<div id="fields">				<input type="text" name="tfa" value="" class="center" placeholder="Code from Google" />			</div>			<div id="bottom"><input id="submit" name="submit" type="submit" value="Disable" /></div>		</div>		<? if ($error) { ?>		<div id="red"><?= htmlspecialchars($error); ?></div>		<? } ?>		<? if ($success) { ?>		<div id="green">2FA disabled successfully</div>		<? } ?>	</form>	<? } else { ?>	<?		$user_save = model_admin_tfa::generateRandomClue();		$db_save = model_admin_tfa::encode($user_save);	?>	<form name="enable_tfa_form" method="post" action="">		<input type="hidden" name="action" value="tfa_enable" />		<input type="hidden" name="tfas" value="<?= $db_save; ?>" />		<div id="login">			<div id="top">2FA is <span class="red">DISABLED</span></div>			<div class="form_info"><img src="<?= model_admin_tfa::getBarCodeUrl($user->data['username'], 'wow-reign.georgeapostolov.com', $db_save, ''); ?>" /></div>			<div class="form_info">SAVE THIS CODE: <?= $user_save; ?></div>			<div id="fields">				<input type="text" name="tfa" value="" class="center" placeholder="Code from Google" />			</div>			<div id="bottom"><input id="submit" name="submit" type="submit" value="Enable" /></div>		</div>		<? if ($error) { ?>		<div id="red"><?= htmlspecialchars($error); ?></div>		<? } ?>		<? if ($success) { ?>		<div id="green">2FA enabled successfully</div>		<? } ?>	</form>	<? } ?><? $this->view->display('includes/footer'); ?>