<?	class controller_public_register extends base_controller {		public function __construct() {			parent::__construct();		}		public function index() {			$result = array();			if (!empty($_POST) && isset($_POST['action']) && $_POST['action'] == 'register') {				$user = new model_public_user();				$username = (isset($_POST['username']) && $_POST['username'] ? trim($_POST['username']) : '');				$password = (isset($_POST['password']) && $_POST['password'] ? trim($_POST['password']) : '');				$password2 = (isset($_POST['password2']) && $_POST['password2'] ? trim($_POST['password2']) : '');				$result = $user->register($username, $password, $password2);				if ($result['success'] == 1) {					header('Location: ' . ROOT_URL);				} else {					/*					if (isset($_SESSION['tfa_enabled'])) {						header('Location: ' . ROOT_URL . 'login/tfa');						return;					}					*/				}			}			$this->view->set('result', $result);			$this->view->set('title', 'register index');			$this->view->display('register/index');		}	}