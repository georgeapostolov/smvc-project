
	jQuery.fn.extend({		autoHeight: function(){			function autoHeight_(element){				return jQuery(element)				.css({'height': 'auto', 'overflow-y': 'hidden'})				.height(element.scrollHeight);			}			return this.each(function(){				autoHeight_(this).on('input', function(){					autoHeight_(this);				});			});		}	});	function repopulate_chatbox() {		$.ajax({			'url': '/chatbox/ajax',			'method': 'POST',			'data': {				'action': 'get_chatbox'			},			'dataType': 'json',			'success': function(result){				if (true == result.success) {					$('#chatbox_text_container').html(result.success_data);					$('#chatbox_text_container').scrollTop($('#chatbox_text_container')[0].scrollHeight);				}			}		});	};	$(document).ready(function(){				$('#chatbox_text_input textarea').keyup(function(e){			var inputbox = $('#chatbox_text_input textarea');			if (13 == e.which) {				var content = inputbox.val().trim();				if (e.shiftKey) {					console.log('new line with shift, do nothing');				} else {					$.ajax({						'url': '/chatbox/ajax',						'method': 'POST',						'data': {							'action': 'add_message',							'message': content						},						'dataType': 'json',						'success': function(result){							if (true == result.success) {								repopulate_chatbox();							}						}					});					inputbox.val('').autoHeight();				}			}		});				$('textarea').autoHeight();				repopulate_chatbox();		setInterval('repopulate_chatbox()', 10000);	});
	